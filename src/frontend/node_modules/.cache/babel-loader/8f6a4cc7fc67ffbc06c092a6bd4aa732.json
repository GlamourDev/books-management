{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Henry\\\\Pictures\\\\tlnsadama kliendipinnacroppedimages\\\\react-and-spring-master\\\\frontend\\\\src\\\\component\\\\EditBooksComponent.jsx\";\nimport React, { Component } from \"react\";\nimport { Formik, Form, Field, ErrorMessage } from \"formik\";\nimport BooksDataService from \"../service/BooksDataService\";\nimport CommentsDataService from \"../service/CommentsDataService\";\n\nvar EditBooksComponent =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EditBooksComponent, _Component);\n\n  function EditBooksComponent(props) {\n    var _this;\n\n    _classCallCheck(this, EditBooksComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EditBooksComponent).call(this, props));\n\n    _this.getDate = function () {\n      var date = new Date().toDateString().slice(0, 10);\n\n      _this.setState({\n        date: date\n      });\n    };\n\n    _this.state = {\n      id: _this.props.match.params.id,\n      author: \"\",\n      date: \"\",\n      description: \"\",\n      comments: [],\n      isbn: \"\"\n    };\n    _this.onSubmit = _this.onSubmit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onSubmitComment = _this.onSubmitComment.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.validate = _this.validate.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.refreshComments = _this.refreshComments.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(EditBooksComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      console.log(this.state.id);\n      this.getDate();\n      this.refreshComments(); // eslint-disable-next-line\n\n      if (this.state.id == -1) {\n        return;\n      }\n\n      BooksDataService.retrieveBook(this.state.id).then(function (response) {\n        return _this2.setState({\n          description: response.data.description,\n          author: response.data.author,\n          isbn: response.data.isbn,\n          commentCount: response.data.commentCount\n        });\n      });\n      CommentsDataService.retrieveComment(this.state.id).then(function (response) {\n        return _this2.setState({\n          comments: response.data.comments,\n          timestamp: response.data.timestamp\n        });\n      });\n    }\n  }, {\n    key: \"validate\",\n    value: function validate(values) {\n      var errors = {};\n\n      if (!values.description) {\n        errors.description = \"Enter a Description\";\n      } else if (values.description.length < 5) {\n        errors.description = \"Enter atleast 5 Characters in Description\";\n      }\n\n      return errors;\n    }\n  }, {\n    key: \"refreshComments\",\n    value: function refreshComments() {\n      var _this3 = this;\n\n      CommentsDataService.retrieveAllComments() //HARDCODED\n      .then(function (response) {\n        console.log(response);\n\n        _this3.setState({\n          comments: response.data\n        });\n      });\n    }\n  }, {\n    key: \"onSubmit\",\n    value: function onSubmit(values) {\n      var _this4 = this;\n\n      var book = {\n        id: this.state.id,\n        description: values.description,\n        author: values.author,\n        isbn: values.isbn,\n        targetDate: values.targetDate,\n        commentCount: values.commentCount\n      };\n\n      if (this.state.id === \"-1\") {\n        BooksDataService.createBook(book).then(function () {\n          return _this4.props.history.push(\"/books\");\n        });\n      } else {\n        console.log(\"EI JOOKSE\");\n        BooksDataService.updateBook(this.state.id, book).then(function () {\n          return _this4.props.history.push(\"/books\");\n        });\n      }\n\n      console.log(values);\n    }\n  }, {\n    key: \"onSubmitComment\",\n    value: function onSubmitComment(values) {\n      var _this5 = this;\n\n      var comment = {\n        id: this.state.id,\n        comments: values.comments,\n        timestamp: this.state.date\n      };\n      console.log(comment.timestamp);\n\n      if (this.state.id === \"-1\") {\n        console.log(\"JOOKSEB\");\n        CommentsDataService.createComment(comment).then(function () {\n          return _this5.props.history.push(\"/books\");\n        });\n      } else {\n        console.log(\"EI JOOKSE\");\n        CommentsDataService.updateComment(this.state.id, comment).then(function () {\n          return _this5.props.history.push(\"/books\");\n        });\n      }\n\n      console.log(values);\n      console.log(\"COMMENT:\", this.comments);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          description = _this$state.description,\n          id = _this$state.id,\n          author = _this$state.author,\n          isbn = _this$state.isbn,\n          comments = _this$state.comments,\n          date = _this$state.date;\n      console.log(this.state.comments);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-sm-6 first-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, \"Edit book\"), React.createElement(Formik, {\n        initialValues: {\n          id: id,\n          description: description,\n          author: author,\n          isbn: isbn\n        },\n        onSubmit: this.onSubmit,\n        validateOnChange: false,\n        validateOnBlur: false,\n        validate: this.validate,\n        enableReinitialize: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, function (props) {\n        return React.createElement(Form, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, React.createElement(ErrorMessage, {\n          name: \"description\",\n          component: \"div\",\n          className: \"alert alert-warning\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }), React.createElement(\"fieldset\", {\n          className: \"form-group\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }, \"Id\"), React.createElement(Field, {\n          className: \"form-control\",\n          type: \"text\",\n          name: \"id\",\n          disabled: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        })), React.createElement(\"fieldset\", {\n          className: \"form-group\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"Title\"), React.createElement(Field, {\n          className: \"form-control\",\n          type: \"text\",\n          name: \"description\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        })), React.createElement(\"fieldset\", {\n          className: \"form-group\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, \"Author\"), React.createElement(Field, {\n          className: \"form-control\",\n          type: \"text\",\n          name: \"author\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        })), React.createElement(\"fieldset\", {\n          className: \"form-group\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }, \"ISBN-13\"), React.createElement(Field, {\n          className: \"form-control\",\n          type: \"text\",\n          name: \"isbn\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          className: \"btn btn-success float-right\",\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, \"Update\"));\n      })), React.createElement(\"div\", {\n        className: \"col-sm-6 second-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"Comments\"), React.createElement(Formik, {\n        onSubmit: this.onSubmitComment,\n        enableReinitialize: true,\n        initialValues: {\n          id: id,\n          comments: comments\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, function (props) {\n        return React.createElement(Form, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, React.createElement(\"fieldset\", {\n          className: \"form-group\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, React.createElement(Field, {\n          className: \"form-control\",\n          type: \"text\",\n          name: \"id\",\n          disabled: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, \"Comment\"), React.createElement(Field, {\n          className: \"form-control\",\n          type: \"text\",\n          name: \"comments\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          className: \"btn btn-success float-right\",\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }, \"Add comment\"));\n      }), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, this.state.comments.map(function (book) {\n        return React.createElement(\"tr\", {\n          key: book.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218\n          },\n          __self: this\n        }, book.id), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, book.comments));\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, date))))));\n    }\n  }]);\n\n  return EditBooksComponent;\n}(Component);\n\nexport default EditBooksComponent;","map":{"version":3,"sources":["C:\\Users\\Henry\\Pictures\\tlnsadama kliendipinnacroppedimages\\react-and-spring-master\\frontend\\src\\component\\EditBooksComponent.jsx"],"names":["React","Component","Formik","Form","Field","ErrorMessage","BooksDataService","CommentsDataService","EditBooksComponent","props","getDate","date","Date","toDateString","slice","setState","state","id","match","params","author","description","comments","isbn","onSubmit","bind","onSubmitComment","validate","refreshComments","console","log","retrieveBook","then","response","data","commentCount","retrieveComment","timestamp","values","errors","length","retrieveAllComments","book","targetDate","createBook","history","push","updateBook","comment","createComment","updateComment","map"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Formik, Form, Field, ErrorMessage } from \"formik\";\nimport BooksDataService from \"../service/BooksDataService\";\nimport CommentsDataService from \"../service/CommentsDataService\";\n\nclass EditBooksComponent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      id: this.props.match.params.id,\n      author: \"\",\n      date: \"\",\n      description: \"\",\n      comments: [],\n      isbn: \"\"\n    };\n\n    this.onSubmit = this.onSubmit.bind(this);\n    this.onSubmitComment = this.onSubmitComment.bind(this);\n    this.validate = this.validate.bind(this);\n    this.refreshComments = this.refreshComments.bind(this);\n  }\n\n  componentDidMount() {\n    console.log(this.state.id);\n    this.getDate();\n    this.refreshComments();\n\n    // eslint-disable-next-line\n    if (this.state.id == -1) {\n      return;\n    }\n\n\n\n    BooksDataService.retrieveBook(this.state.id).then(response =>\n      this.setState({\n        description: response.data.description,\n        author: response.data.author,\n        isbn: response.data.isbn,\n        commentCount: response.data.commentCount\n      })\n    );\n\n    CommentsDataService.retrieveComment(this.state.id).then(response =>\n      this.setState({\n        comments: response.data.comments,\n        timestamp: response.data.timestamp\n      })\n    );\n  }\n  validate(values) {\n    let errors = {};\n    if (!values.description) {\n      errors.description = \"Enter a Description\";\n    } else if (values.description.length < 5) {\n      errors.description = \"Enter atleast 5 Characters in Description\";\n    }\n\n    return errors;\n  }\n\n  getDate = () => {\n    var date = new Date().toDateString().slice(0,10);\n    this.setState({ date });\n  };\n\n  refreshComments() {\n    CommentsDataService.retrieveAllComments() //HARDCODED\n      .then(response => {\n        console.log(response);\n        this.setState({ comments: response.data });\n      });\n  }\n\n  onSubmit(values) {\n    let book = {\n      id: this.state.id,\n      description: values.description,\n      author: values.author,\n      isbn: values.isbn,\n      targetDate: values.targetDate,\n      commentCount: values.commentCount\n    };\n\n    if (this.state.id === \"-1\") {\n      BooksDataService.createBook(book).then(() =>\n        this.props.history.push(\"/books\")\n      );\n    } else {\n      console.log(\"EI JOOKSE\");\n      BooksDataService.updateBook(this.state.id, book).then(() =>\n        this.props.history.push(\"/books\")\n      );\n    }\n    console.log(values);\n  }\n\n  onSubmitComment(values) {\n    let comment = {\n      id: this.state.id,\n      comments: values.comments,\n      timestamp: this.state.date\n    };\n    console.log(comment.timestamp);\n    if (this.state.id === \"-1\") {\n      console.log(\"JOOKSEB\");\n      CommentsDataService.createComment(comment).then(() =>\n        this.props.history.push(\"/books\")\n      );\n    } else {\n      console.log(\"EI JOOKSE\");\n      CommentsDataService.updateComment(this.state.id, comment).then(() =>\n        this.props.history.push(\"/books\")\n      );\n    }\n    console.log(values);\n    console.log(\"COMMENT:\",this.comments);\n  }\n\n  render() {\n    let { description, id, author, isbn, comments, date } = this.state;\n    console.log(this.state.comments)\n    return (\n      <div>\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col-sm-6 first-column\">\n              <h3>Edit book</h3>\n              <Formik\n                initialValues={{ id, description, author, isbn }}\n                onSubmit={this.onSubmit}\n                validateOnChange={false}\n                validateOnBlur={false}\n                validate={this.validate}\n                enableReinitialize={true}\n              >\n                {props => (\n                  <Form>\n                    <ErrorMessage\n                      name=\"description\"\n                      component=\"div\"\n                      className=\"alert alert-warning\"\n                    />\n                    <fieldset className=\"form-group\">\n                      <label>Id</label>\n                      <Field\n                        className=\"form-control\"\n                        type=\"text\"\n                        name=\"id\"\n                        disabled\n                      />\n                    </fieldset>\n                    <fieldset className=\"form-group\">\n                      <label>Title</label>\n                      <Field\n                        className=\"form-control\"\n                        type=\"text\"\n                        name=\"description\"\n                      />\n                    </fieldset>\n                    <fieldset className=\"form-group\">\n                      <label>Author</label>\n                      <Field\n                        className=\"form-control\"\n                        type=\"text\"\n                        name=\"author\"\n                      />\n                    </fieldset>\n                    <fieldset className=\"form-group\">\n                      <label>ISBN-13</label>\n                      <Field className=\"form-control\" type=\"text\" name=\"isbn\" />\n                    </fieldset>\n                    <button\n                      className=\"btn btn-success float-right\"\n                      type=\"submit\"\n                    >\n                      Update\n                    </button>\n                  </Form>\n                )}\n              </Formik>\n            </div>\n            <div className=\"col-sm-6 second-column\">\n              <h3>Comments</h3>\n              <Formik onSubmit={this.onSubmitComment} \n              enableReinitialize={true}\n              initialValues={{ id, comments }}>\n                {props => (\n                  <Form>\n                    <fieldset className=\"form-group\">\n                      <Field\n                        className=\"form-control\"\n                        type=\"text\"\n                        name=\"id\"\n                        disabled\n                      />\n                      <label>Comment</label>\n                      <Field\n                        className=\"form-control\"\n                        type=\"text\"\n                        name=\"comments\"\n                      />\n                    </fieldset>\n                    <button\n                      className=\"btn btn-success float-right\"\n                      type=\"submit\"\n                    >\n                      Add comment\n                    </button>\n                  </Form>\n                )}\n              </Formik>\n              <tbody>\n              {this.state.comments.map(book => (\n                <tr key={book.id}>\n                  <td>{book.id}</td>\n                  <td>{book.comments}</td>\n                </tr>\n              ))}\n              <div>{date}</div>\n            </tbody>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default EditBooksComponent;\n"]},"metadata":{},"sourceType":"module"}